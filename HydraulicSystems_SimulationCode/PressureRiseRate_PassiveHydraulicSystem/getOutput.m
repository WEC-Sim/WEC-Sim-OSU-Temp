function simData = getOutput(simSol, pto, wec, wave)

% Extract Simulation Data
simData.simSol      = simSol;
simData.time        = simSol.x;
simData.x           = simSol.y;
simData.u           = pto.alpha_i;
simData.pA          = simSol.y(1,:);
simData.pB          = simSol.y(2,:);
simData.vC          = simSol.y(3,:);
simData.vD          = simSol.y(4,:);
simData.omega       = simSol.y(5,:);
simData.z           = simSol.y(6,:);
simData.zDot        = simSol.y(7,:);
simData.alpha       = simData.u(1);
simData.bg          = pto.bg; 
simData.Fe          = interp1(wave.sig.tFe, wave.sig.Fe, simData.time, 'cubic', 'extrap');
simData.eta         = interp1(wave.sig.tFe, wave.sig.eta, simData.time, 'cubic', 'extrap');
simData.etaDot      = interp1(wave.sig.tFe, wave.sig.etaDot, simData.time, 'cubic', 'extrap');
simData.eta2Dot     = interp1(wave.sig.tFe, wave.sig.eta2Dot, simData.time, 'cubic', 'extrap');
simData.zDotOpt     = simData.Fe/2/wec.B;
simData.T_gen       = simData.omega*pto.bg;
simData.vA          = pto.V0 - pto.Ap*simData.z;%pto.pA0./(1-simData.vA./pto.vA0).^(1.4);
simData.vB          = pto.V0 + pto.Ap*simData.z;%pto.pB0./(1-simData.vB./pto.vB0).^(1.4);
simData.pC          = pto.pC0./(1-simData.vC./pto.vC0).^(1.4);
simData.pD          = pto.pD0./(1-simData.vD./pto.vD0).^(1.4);
simData.Fpto        = pto.Ap*(simData.pA - simData.pB);
simData.P_exc       = simData.Fe.*simData.zDot;
simData.P_excOpt    = simData.Fe.*simData.zDotOpt;
simData.P_hyd       = simData.Fpto.*simData.zDot;
simData.P_hydOpt    = simData.Fpto.*simData.zDotOpt;
simData.P_gen       = simData.T_gen.*simData.omega;
simData.k1          = pto.k1;
simData.k2          = pto.k2; 
simData.Vdot_p      = pto.Ap*simData.zDot;
simData.Vdot_m      = simData.u(1)*pto.D*simData.omega;
simData.Vdot_1      = calcVdotCV2(simData.pA, simData.pC, pto.Cd,pto.rho,pto.Rt,pto.Dh,pto.v,pto.k1,pto.av1,pto.av2,pto.av3,pto.k2);
simData.Vdot_2      = calcVdotCV2(simData.pB, simData.pC, pto.Cd,pto.rho,pto.Rt,pto.Dh,pto.v,pto.k1,pto.av1,pto.av2,pto.av3,pto.k2);
simData.Vdot_3      = calcVdotCV2(simData.pD, simData.pB, pto.Cd,pto.rho,pto.Rt,pto.Dh,pto.v,pto.k1,pto.av1,pto.av2,pto.av3,pto.k2);
simData.Vdot_4      = calcVdotCV2(simData.pD, simData.pA, pto.Cd,pto.rho,pto.Rt,pto.Dh,pto.v,pto.k1,pto.av1,pto.av2,pto.av3,pto.k2);
